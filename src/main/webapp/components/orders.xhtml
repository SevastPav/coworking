<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:sec="http://www.springframework.org/security/tags"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<ui:composition>
    <div class="ui-g-12 ui-g-nopad mt-2">
        <div class="ui-g-7 ui-g-nopad">
            <ui:repeat var="reservation" value="#{orderBean.activeUserReservations}" varStatus="status">
                <h:form>
                    <div class="ui-g-12 ui-g-nopad mt-2 card">
                        <div class="ui-g-12 ui-g-nopad">
                            <div class="ui-g-5 ui-g-nopad">
                                <p:graphicImage cache="false" value="#{imageService.image}" width="265">
                                    <f:param name="image_id"
                                             value="#{reservation.placeId.officeId.officeMainImage.imageId}"/>
                                </p:graphicImage>
                            </div>
                            <div class="ui-g-7 ui-g-nopad">
                                <div class="ui-g-12 ui-g-nopad">
                                    <h5 class="card-title">#{reservation.placeId.officeId.title}</h5>
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    Номер места: #{reservation.placeId.internalPlaceId}
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    Описание места: #{reservation.placeId.description}
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    Тип аренды: #{reservation.rentTypeId.title}
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    Продолжительность: #{reservation.durationTypeId.title}
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    Оплачено: #{reservation.paid}
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    <small class="text-muted">
                                        Дата: #{reservation.date}
                                    </small>
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    <small class="text-muted">
                                        Время: #{reservation.time}
                                    </small>
                                </div>
                                <div class="ui-g-12 ui-g-nopad">
                                    <div class="ui-g-6">
                                        <p:commandButton value="Оплатить"
                                                         rendered="#{not reservation.paid}"
                                                         ajax="false"
                                                         actionListener="#{orderBean.payReservation(reservation.reservationId)}"
                                                         update="@form"/>
                                    </div>
                                    <div class="ui-g-6">
                                        <p:commandButton value="Отменить"
                                                         ajax="false"
                                                         actionListener="#{orderBean.cancelReservation(reservation.reservationId)}"
                                                         update="@form"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </h:form>
            </ui:repeat>
        </div>
        <div class="ui-g-5">

        </div>
    </div>
</ui:composition>
</html>